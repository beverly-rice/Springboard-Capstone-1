Beverly Rice
Springboard Capstone 1 Milestone Report
26 Dec 2017

Project: WSDM – KKBox’s Churn Prediction Challenge
Source: Kaggle, https://www.kaggle.com/c/kkbox-churn-prediction-challenge

Background: KKBox is Asia’s leading music streaming service, holding the 
world’s most comprehensive Asia-Pop music library with over 30 million 
tracks.  They have expanded to support Windows, Mac OS X, IOS, Android, 
Symbian, Bada, and Java phones.  Subscribers have praised the service’s 
relevance of search results, advanced search function, and content search 
function over similar providers.  To support operations, the company offers 
freemium and “pay-per-month” subscriptions.    

Problem: Build an algorithm that accurately predicts whether a paid KKBox 
user will not renew or purchase a new subscription within 30 days post 
membership expiration.

Client: KKBox dominated the market in 2008 with 80% market share and in 
2015 announced that they acquired over 10 million cumulative users in 
the past decade.  They’ve boasted over 1600 registered artists and celebrities 
and currently compete with Apple iTunes, Spotify, and YouTube. They hope to 
identify factors that contribute to why users leave so they can be proactive 
in maintaining their customers. 

Data: KKBox provided 5 files in the challenge: 
  1. train_v2: the train set containing user IDs and whether they have churned
  
  2. members_v3: select user information to include member ID, city, age, 
  gender, registration method, and registration initialization time
  
  3. transactions_v2: transactions of users until March 31, 2017 - includes
  user ID, payment method, payment plan, plan price, amount paid, whether
  the member opted to auto-renew or auto-cancel their subscription, 
  transaction date, and membership expiration date
  
  4. user_logs_v2: daily user logs describing listening behaviors of select 
  users - includes user ID, date of log, the number of songs played less 
  than 25% of the song length, between 25-50% of the song length, between 50-75%
  of the song length, between 75-98.5% of the song length, and over 98.5% of the
  song length.  It also includes the number of unique songs and the total seconds 
  played for the given log entry
  
  5. sample_submission_v2: the test set, containing the user IDs in the format 
  KKBox expects it to be submitted in - it incnludes the user ID and churn prediction

The dependent variable is whether a user will churn after their subscription expires.
Specifically, KKBox wants to see if a user will/will not purchase a new service subscription 
within 30 days of their current membership expiration date.  

The train and the test data are selected from users whose membership expire within 
a certain month. The train data consists of users whose subscription expires within 
the month of February 2017, and the test data is with users whose subscription 
expires within the month of March 2017. This means we are looking at user churn or 
renewal roughly in the month of March 2017 for train set, and the user churn or 
renewal roughly in the month of April 2017. 

Data Wrangling Steps Performed
Step 1: Conduct Initial Explortory Data Analysis
  - Applied .info() to each file to view entries, columns and types.  
    Also used .info() and isnull () to determine if there were any 
    null values
  - Applied .describe() to each file to get count/mean/std/min/max 
    25/50/75 for each column
  - Applied .columns to get just the names of each column
  - Applied .duplicated() to each file to determine if there were 
    any duplicate entries
  - Applied .head() to get initial visual of data
  - Applied .size and .unique() to ID unique values for each column
  - Applied .loc() to slice data

Step 2: Conduct Visual Exploratory Analysis
  - Plotted frequency counts for categorical data
  - Applied pd.to_datetime() to convert dates to the appropriate format
  - Plotted frequency counts for time variables
  - Bucketed data for clearer visuals
  - Dropped duplicate 'subscriptions/activity' from same member
  - Plotted single subscription/activity for each member with respect 
    to each variable 
  - Identified outliers
  - Visualized multiple variables

Step 3: Create New Variables
  - Applied groupby(), sum(), and count() 
  - Narrowed down dates to month, weekday, and day of month
  - Logically deduced info from existing variables
  - Plotted frequency counts for new variables

Step 4: Combine Files for Further Analysis
  - Applied concat(), merge(), and to_csv() 
  - Removed dirty/erroneous data
  - Dropped duplicate data
  - Created additional variables

List of changes made to the data
1.  Removed ‘bd’ variable – ranged from -7000 to +2000 and over 67% 
    reported an age of ‘0’
2.  Removed ‘gender’ variable – 65% did not report a gender; analysis 
    shows that reported males and females churned at a very similar 
    rate, 17.6% and 16.9% respectively.  
3.  Removed members who registered before 2010 – KKBox went international 
    in 2009 and also received investments from at least 2 big-name companies; 
    there was a significant increase in membership starting in 2010
4.  Added Variable - registration day and month
5.  Added Boolean – whether member used multiple payment methods
6.  Added Boolean – whether member used multiple payment plans
7.  Added Boolean – whether member received a discount
8.  Added Variable – total subscriptions per member
9.  Added Variable – total membership time
10. Added Variable – total days used
11. Added Variable – total songs listened to throughout membership
12. Added Variable – total songs listened to more than once
13. Added Variables – percentage of songs listened to for only 25%, 50%, 75%, 
    98.5% and 100% of the song length throughout membership
14. Created master file containing a single entry for each member with 
    variables for further analysis

Important findings

See Data Wrangling.ipynb in this repository for wrangling/analysis details

